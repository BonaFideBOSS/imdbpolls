function monthsChecker(t){const e=[];for(var a=0;a<t.length;a++)switch(t[a]){case"1":e.push("Jan");break;case"2":e.push("Feb");break;case"3":e.push("Mar");break;case"4":e.push("Apr");break;case"5":e.push("May");break;case"6":e.push("Jun");break;case"7":e.push("Jul");break;case"8":e.push("Aug");break;case"9":e.push("Sep");break;case"10":e.push("Oct");break;case"11":e.push("Nov");break;case"12":e.push("Dec")}return e}function timelapse(t){var e=new Date,a=Math.abs(e-new Date(t)),l=a,o=Math.ceil(a/1e3),n=Math.ceil(a/6e4),s=Math.round(a/36e5),r=Math.round(a/864e5),d=Math.round(a/2592e6),i=Math.round(a/31104e6);if(a=l+" milliseconds ago",o>=1&&o<60){var h=o>1?" seconds ago":" second ago";a=o+h}else if(n>=1&&n<60){h=n>1?" minutes ago":" minute ago";a=n+h}else if(s>=1&&s<24){h=s>1?" hours ago":" hour ago";a=s+h}else if(r>=1&&r<30){h=r>1?" days ago":" day ago";a=r+h}else if(d>=1&&d<12){h=d>1?" months ago":" month ago";a=d+h}else if(i>=1){h=i>1?" years ago":" year ago";a=i+h}return a}const file=new XMLHttpRequest;file.open("GET","pollData/allimdbpolls.json"),file.send(),file.onreadystatechange=function(){var t=[],e=[],a=[],l=[],o=[],n=[],s=[],r=[],d=[],i=[],h=[];if(4==this.readyState&&200==this.status){var c=JSON.parse(file.responseText);userID="ur75779804";var u=location.hash.match(/#([^&]+)/i),p=u&&u[1];p&&c.authors.some(t=>t.authorid==p)&&(userID=p);var m=c.polls.filter(t=>t.authorid===userID),g=c.authors.filter(t=>t.authorid===userID);document.title="IMDb Polls by "+m[0].author,$(".username").html(m[0].author),$(".userprofile,.navbar-brand").attr("href","https://www.imdb.com/user/"+userID),""!=g[0].avatar&&$(".userprofilepic").attr("src",g[0].avatar);for(var b=m.length,f=0,y=0,C=0;C<m.length;C++)f+=m[C].votes,"yes"==m[C].featured.toLowerCase()&&(y+=1);var v,k,M,w,E=c.lastupdated,x=c.rawdate,D=0,P=Number.MAX_VALUE,O=0,S=0,I=0,j=new Date,B=new Date(0);$("#cardtotalpolls").html(b),$("#cardtotalvotes").html(f.toLocaleString()),$("#cardtotalhp").html(y),$("#avgvotes").html(Math.round(f/b).toLocaleString());var T=document.getElementById("imdbpolls"),L=T.getElementsByTagName("tbody")[0],_=T.getElementsByTagName("caption")[0],A=[];for(C=0;C<m.length;C++){if(A.push(m[C].date),new Date(j)>new Date(m[C].date)&&(j=m[C].date,$("#firstpolldate").html(new Date(j).toDateString()),$("#authorsfirstpoll .card-title").html(m[C].title),$("#authorsfirstpoll a").attr("href",m[C].url)),new Date(B)<new Date(m[C].date)){B=m[C].date,$("#lastpolldate").html(new Date(B).toDateString());var q=m[C];$("#latest-poll .card-header span").html(new Date(q.date).toDateString()),$("#latest-poll .card-title").html(q.title),$("#latest-poll .card-text span").html(q.votes),$("#latest-poll a").attr("href",q.url)}const c=864e5;var z=Math.round(Math.abs((new Date(j)-new Date)/c));if(0==z&&(z=1),$("#avgvotesdaily").html((f/z).toFixed(3).toLocaleString()),m[C].votes>=1e3&&(O+=1),m[C].votes>=5e3&&(S+=1),m[C].votes>=1e4&&(I+=1),D<m[C].votes&&(D=m[C].votes,v=m[C].title,k=m[C].url),P>=m[C].votes&&(P=m[C].votes,M=m[C].title,w=m[C].url),$("#1kvotes").html(O),$("#5kvotes").html(S),$("#10kvotes").html(I),$("#maxvotes").html(D.toLocaleString()),$("#minvotes").html(P.toLocaleString()),$("#highestvotedpoll .card-title").html(v),$("#highestvotedpoll .card-header a").attr("href",k),$("#lowestvotedpoll .card-title").html(M),$("#lowestvotedpoll .card-header a").attr("href",w),m[C].date){var N=m[C].date.split("/")[0],F=m[C].date.split("/")[1].replace(/^0+/,"");m[C].date.split("/")[2].replace(/^0+/,"")}t.push(N),2013==N?e.push(F):2014==N?a.push(F):2015==N?l.push(F):2016==N?o.push(F):2017==N?n.push(F):2018==N?s.push(F):2019==N?r.push(F):2020==N?d.push(F):2021==N?i.push(F):2022==N&&h.push(F),$(L).append('<tr><td></td><td nowrap><a href="'+m[C].url+'" target="_blank">'+m[C].title+"</a></td><td>"+m[C].date+"</td><td>"+m[C].votes.toLocaleString()+"</td><td>"+m[C].type+"</td><td>"+m[C].featured+"</td><td>"+m[C].status+"</td></tr>")}var V,H=1,J=0;for(C=0;C<A.length;C++){for(var W=C;W<A.length;W++)A[C]==A[W]&&J++,H<J&&(H=J,V=A[C]);J=0}1==H&&(V=A[0]),$("#mostpollsinaday").html(H),$("#daywithmostpolls").html(new Date(V).toDateString()),$(_).html("Data as of "+E+" ("+timelapse(x)+")"),$(document).ready(function(){function e(){for(var t=document.querySelectorAll("#imdbpolls tbody tr"),e=document.getElementById("imdbpolls_length").getElementsByTagName("select")[0].value,a=$("#imdbpolls_paginate .paginate_button.current").html().replace(",",""),l=e*a-e,o=0;o<t.length;o++)t[o].querySelectorAll("td")[0].classList.contains("dataTables_empty")||(l+=1,t[o].querySelectorAll("td")[0].innerHTML=l)}function a(){var t=n.rows({search:"applied"}).count(),e=document.querySelectorAll("#imdbpolls tbody tr"),a=document.getElementById("imdbpolls_length").getElementsByTagName("select")[0].value,l=$("#imdbpolls_paginate .paginate_button.current").html().replace(",",""),o=a*l-a;o=t-o;for(var s=0;s<e.length;s++)e[s].querySelectorAll("td")[0].classList.contains("dataTables_empty")||(e[s].querySelectorAll("td")[0].innerHTML=o--)}function l(){for(var t=document.querySelectorAll("#imdbpolls tbody tr"),e=0,a=0,l=0;l<t.length;l++)t[l].querySelectorAll("td")[0].classList.contains("dataTables_empty")||(e+=parseInt(t[l].querySelectorAll("td")[3].textContent.replace(",","")),"yes"==t[l].querySelectorAll("td")[5].textContent.toLowerCase()&&(a+=1));$("#sum-votes").html(e.toLocaleString()),$("#sum-features").html(a)}for(var o,n=$(T).DataTable({order:[[3,"desc"]],lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],columnDefs:[{targets:[0],orderable:!1}]}),s=t.filter((t,e,a)=>a.indexOf(t)===e),r=0;r<s.length;r++)o+="<option>"+s[r]+"</option>";$("#year-filter").append(o),$("#year-filter").on("change",function(){var t=$(this).val();n.columns(2).search(t).draw()}),$("#type-filter").on("change",function(){var t=$(this).val();n.columns(4).search(t).draw()}),$("#hp-filter").on("change",function(){var t=$(this).val();n.columns(5).search(t).draw()}),$("#status-filter").on("change",function(){var t=$(this).val();n.columns(6).search(t).draw()}),l(),e(),$(".custom-filter select,#imdbpolls_length select").on("change",function(){l(),$("#imdbpolls thead .sorting").hasClass("sorting_desc")?e():a()}),$("#imdbpolls_filter input").on("input",function(){l(),$("#imdbpolls thead .sorting").hasClass("sorting_desc")?e():a()}),$("#imdbpolls thead .sorting,#imdbpolls_paginate").on("click",function(){l(),$("#imdbpolls thead .sorting").hasClass("sorting_desc")?e():a()})}),setTimeout(()=>{Chart.defaults.plugins.tooltip.displayColors=!1,Chart.defaults.plugins.tooltip.intersect=!1,Chart.defaults.plugins.tooltip.padding="10",Chart.defaults.plugins.tooltip.footerMarginTop=15;const c={},u={},p={},m={},g={},C={},k={},M={},w={},E={},x={};t.forEach(function(t){c[t]=(c[t]||0)+1}),e.forEach(function(t){u[t]=(u[t]||0)+1}),a.forEach(function(t){p[t]=(p[t]||0)+1}),l.forEach(function(t){m[t]=(m[t]||0)+1}),o.forEach(function(t){g[t]=(g[t]||0)+1}),n.forEach(function(t){C[t]=(C[t]||0)+1}),s.forEach(function(t){k[t]=(k[t]||0)+1}),r.forEach(function(t){M[t]=(M[t]||0)+1}),d.forEach(function(t){w[t]=(w[t]||0)+1}),i.forEach(function(t){E[t]=(E[t]||0)+1}),h.forEach(function(t){x[t]=(x[t]||0)+1});var P=50*Math.ceil(b/50);P==b&&(P+=50),$("#m1Text").html((b/P*100).toFixed(2)+"%");const O={labels:["Polls Published","Polls needed to reach next milestone"],datasets:[{backgroundColor:["#0dcaf0","#212529"],borderWidth:"0",data:[b,P-b]}]};var S=5e4*Math.ceil(f/5e4);S==f&&(S+=5e4),$("#m2Text").html((f/S*100).toFixed(2)+"%");const I={labels:["Votes Gained","Votes needed to reach next milestone"],datasets:[{backgroundColor:["#0dcaf0","#212529"],borderWidth:"0",data:[f,S-f]}]};var j=10*Math.ceil(y/10);j==y&&(j+=10),$("#m3Text").html((y/j*100).toFixed(2)+"%");const B={labels:["Featured Polls","More features needed"],datasets:[{backgroundColor:["#0dcaf0","#212529"],borderWidth:"0",data:[y,j-y]}]};var T=5e3*Math.ceil(D/5e3);T==b&&(T+=5e4),$("#m4Text").html((D/T*100).toFixed(2)+"%");const L={labels:["Highest Vote","Votes needed to reach next milestone"],datasets:[{backgroundColor:["#0dcaf0","#212529"],borderWidth:"0",data:[D,T-D]}]},_={type:"doughnut",data:O,options:{plugins:{legend:{display:!1},tooltip:{callbacks:{footer:function(){return"Next Milestone: "+P}}}}}},A={type:"doughnut",data:I,options:{plugins:{legend:{display:!1},tooltip:{callbacks:{footer:function(){return"Next Milestone: "+S.toLocaleString()}}}}}},q={type:"doughnut",data:B,options:{plugins:{legend:{display:!1},tooltip:{callbacks:{footer:function(){return"Next Milestone: "+j}}}}}},z={type:"doughnut",data:L,options:{plugins:{legend:{display:!1},tooltip:{callbacks:{footer:function(){return"Next Milestone: "+T.toLocaleString()+"\nHighest Voted Poll: "+v}}}}}},N=["#6610f2","#6f42c1","#d63384","#fd7e14","#20c997","#0d6efd","#198754","#0dcaf0","#ffc107","#dc3545"],F={labels:Object.keys(c),datasets:[{backgroundColor:"rgb(255,193,7,.5)",borderColor:"#ffc107",data:Object.values(c)}]},V={labels:monthsChecker(Object.keys(u)),datasets:[{backgroundColor:N.sample(),data:Object.values(u)}]},H={labels:monthsChecker(Object.keys(p)),datasets:[{backgroundColor:N.sample(),data:Object.values(p)}]},J={labels:monthsChecker(Object.keys(m)),datasets:[{backgroundColor:N.sample(),data:Object.values(m)}]},W={labels:monthsChecker(Object.keys(g)),datasets:[{backgroundColor:N.sample(),data:Object.values(g)}]},G={labels:monthsChecker(Object.keys(C)),datasets:[{backgroundColor:N.sample(),data:Object.values(C)}]},X={labels:monthsChecker(Object.keys(k)),datasets:[{backgroundColor:N.sample(),data:Object.values(k)}]},Y={labels:monthsChecker(Object.keys(M)),datasets:[{backgroundColor:N.sample(),data:Object.values(M)}]},R={labels:monthsChecker(Object.keys(w)),datasets:[{backgroundColor:N.sample(),data:Object.values(w)}]},U={labels:monthsChecker(Object.keys(E)),datasets:[{backgroundColor:N.sample(),data:Object.values(E)}]},K={labels:monthsChecker(Object.keys(x)),datasets:[{backgroundColor:N.sample(),data:Object.values(x)}]},Q={type:"line",data:F,options:{plugins:{title:{display:!0,text:"Polls Published Each Year",font:{size:16}},legend:{display:!1}}}},Z={type:"bar",data:V,options:{plugins:{title:{display:!0,text:"Polls Published in 2013",font:{size:16}},legend:{display:!1}}}},tt={type:"bar",data:H,options:{plugins:{title:{display:!0,text:"Polls Published in 2014",font:{size:16}},legend:{display:!1}}}},et={type:"bar",data:J,options:{plugins:{title:{display:!0,text:"Polls Published in 2015",font:{size:16}},legend:{display:!1}}}},at={type:"bar",data:W,options:{plugins:{title:{display:!0,text:"Polls Published in 2016",font:{size:16}},legend:{display:!1}}}},lt={type:"bar",data:G,options:{plugins:{title:{display:!0,text:"Polls Published in 2017",font:{size:16}},legend:{display:!1}}}},ot={type:"bar",data:X,options:{plugins:{title:{display:!0,text:"Polls Published in 2018",font:{size:16}},legend:{display:!1}}}},nt={type:"bar",data:Y,options:{plugins:{title:{display:!0,text:"Polls Published in 2019",font:{size:16}},legend:{display:!1}}}},st={type:"bar",data:R,options:{plugins:{title:{display:!0,text:"Polls Published in 2020",font:{size:16}},legend:{display:!1}}}},rt={type:"bar",data:U,options:{plugins:{title:{display:!0,text:"Polls Published in 2021",font:{size:16}},legend:{display:!1}}}},dt={type:"bar",data:K,options:{plugins:{title:{display:!0,text:"Polls Published in 2022",font:{size:16}},legend:{display:!1}}}};new Chart(document.getElementById("milestoneOne"),_),new Chart(document.getElementById("milestoneTwo"),A),new Chart(document.getElementById("milestoneThree"),q),new Chart(document.getElementById("milestoneFour"),z),new Chart(document.getElementById("YearChart"),Q),2013 in c&&($("#2013MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2013MonthChart"),Z)),2014 in c&&($("#2014MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2014MonthChart"),tt)),2015 in c&&($("#2015MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2015MonthChart"),et)),2016 in c&&($("#2016MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2016MonthChart"),at)),2017 in c&&($("#2017MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2017MonthChart"),lt)),2018 in c&&($("#2018MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2018MonthChart"),ot)),2019 in c&&($("#2019MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2019MonthChart"),nt)),2020 in c&&($("#2020MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2020MonthChart"),st)),2021 in c&&($("#2021MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2021MonthChart"),rt)),2022 in c&&($("#2022MonthChart").parent().attr("hidden",!1),new Chart(document.getElementById("2022MonthChart"),dt)),$(".data-loader.loader-two").hide(),$(".data-loader.loader-three").hide()},3e3),$(".data-loader.loader-one").hide(),$("main").show()}},Array.prototype.sample=function(){return this[Math.floor(Math.random()*this.length)]};